<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="generator" content="RocketCake">
	<title></title>
	<style type="text/css">
		a { color:#5D5D9E; } 
		a:visited { color:#5D5D9E; } 
		a:active { color:#5C615E; } 
		a:hover { color:#B2B3B4; } 
	</style>
</head>
<body style="background-color:#E4E6E8; padding:0;  margin: 0;">
<div style="text-align:center;">
<div style="vertical-align: top; position:relative; display: inline-block; width:100%; min-height:236px; min-width:300px; max-width:1280px; background:none; " id="container_7d1752af"><div style="text-align:center;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/><br/></span><span style="font-size:28pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">3dPvb (3dPureVb) - &#160;A realtime 3d rendering engine written with vb.net</span></div>
<div style="text-align:justify;"><span style="font-size:28pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/></span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/>3dPureVb is a small application for learning delivered with its source code.<br/><br/>This project has for objective to introduce you the basis principles of programming a realtime 3d rendering engine and make you understand its core logic. It suggest you to discover:<br/><br/>&#9679; Setting up 3d polygonal mesh structures by list of vertex and triangles<br/>&#9679; Materials creation with alpha blending support<br/>&#9679; Transforming (translation / rotation), render to screen<br/>&#9679; Back face culling <br/>&#9679; Zoom and perspective modification<br/>&#9679; Direct Manipulation with mouse<br/>&#9679; Lighting<br/><br/>This project is based on one of my early realtime 3d engine project.<br/><br/><br/></span></div>
<div style="text-align:center;"><img src="images/3dpurevb0.png" style="vertical-align: bottom; position:relative; display: inline-block; width:100%; min-width:300px; max-width:1280px; background:none; " id="img_6a5612c4" alt="" title="" />
<span style="font-size:18pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/><br/><br/><br/>Prerequisites</span></div>
<div style="text-align:justify;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/><br/>To open, run and compile the project, you will need Visual Studio version 2012 (or later). The Express and Community editions can be downloaded freely from the official Microsoft website.<br/><br/><br/><br/><br/></span></div>
<div style="text-align:center;"><span style="font-size:18pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">Ok, lets start! Programming a realtime 3d rendering engine</span></div>
<div style="text-align:justify;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/><br/>Launch </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">Visual Studio</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> and open the project solution (3dPvb.sln). In addition to the WinForm, you will see the project is constitued of 7 modules:<br/><br/>&#9679; </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">GDIPlus</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (for drawing Triangles, based on the </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">GDI+ API</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">)<br/>&#9679; </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Geometry</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (Containing all procedures for creating primitives geometry)<br/>&#9679;</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; "> IndexBuffer</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (this will be for storing our vertex, triangles and lighting result)<br/>&#9679;</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; "> Init</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (declaration of global variables and constants needed by the application)<br/>&#9679; </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Main</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (as its name suggest, this is the main module containing Initialisations, and main calls routines of the 3d engine)<br/>&#9679; </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">MathTrans </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">(mathematical transformations like translation, rotation...)<br/>&#9679;</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; "> Render</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (final render with Z sorting)<br/><br/>As usual in event-driving programming, the WinForm code, contains the traditionnal </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Form1_Load()</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> and all necessary procedures for managing the User Interface.<br/><br/><br/></span></div>
<div style="text-align:center;"><img src="images/3dpurevb1a.png" style="vertical-align: bottom; position:relative; display: inline-block; width:100%; min-width:300px; max-width:1280px; background:none; " id="img_f645165" alt="" title="" />
</div>
<div style="text-align:left;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; "><br/><br/>3dPureVb</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> allow you to display and manipulate 3d basis objects. These basis objects are so named </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Primitives</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (cube, cylinder, sphere, torus...)<br/><br/>Lets take a look at how we will do it! I advise you to watch and study the source code at the same time, I think this will probably help you understanding the program logic. <br/><br/>Once application has started, it begin by creating a primitive. This is called by the procedure </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Main3d</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> in the </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Main</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> Module, and is done in the </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Geometry</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> module. So we will first define the primitive structure (also named </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Mesh</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">), by creating a list of vertices (a set of </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">vertex</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">, or corners if you prefer). All of these vertices have a coordinates in space (X,Y,Z).<br/><br/>If you take a look at the procedures in the </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Geometry</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> module, you will see that each primitive has its own one for its geometry construction. For example, a cube is created by calling the procedure named </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">NewMesh_Cube()</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">.<br/><br/></span></div>
<div style="text-align:justify;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/></span></div>
<div style="text-align:center;"><img src="images/3dpurevb2a.png" style="vertical-align: bottom; position:relative; display: inline-block; width:100%; min-width:300px; max-width:1280px; background:none; " id="img_46b0c69c" alt="" title="" />
</div>
<div style="text-align:justify;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/><br/>During each vertex creation, we will need to call the </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Move() </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">and </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Rotate()</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> procedures in the </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">MathTrans</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> module to update the postion and rotation angle of the primitive just being under construction.<br/><br/><br/></span></div>
<div style="text-align:center;"><img src="images/3dpurevb3a.png" style="vertical-align: bottom; position:relative; display: inline-block; width:100%; min-width:300px; max-width:1280px; background:none; " id="img_18f1f132" alt="" title="" />
</div>
<div style="text-align:left;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#000000; "><br/><br/></span></div>
<div style="text-align:justify;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">To construct a primitive, its vertices have to be connected to make triangles. Colours of these triangles are setup by Materials, which is a set of definition for the visual appearence of the object when it is rendered to the screen. In </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">3dPureVb</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">, which is non accelerated and a relative simple 3d engine, materials are just a color definition (Red, Green, Blue and Alpha for the transparency) ..<br/><br/>Note: During the creation process of the triangles, vertices used for this has to be clockwise ! This is very important for managing hidden triangles and back-face culling (removing the triangles who are assumed to be not visible because they are on the back side) . If you dont do this, you will have some strange effects on screen during rendering like triangles showned while they have to be hidden, and so on...<br/><br/>The </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">NewTriangle</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> procedure is very important. This one is called by each primitive creation procedure just after that all vertices are being defined. As indicated by its name, all triangles are created here, and it is also in this procedure that I have included the managing routines for lighting and back-face culling. Then the results are stored in memory thanks to our </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">IndexBuffer</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> , which is a set of variables used to &#160;register all necessary datas for sorting and rendering all the computed triangles.<br/><br/><br/></span></div>
<div style="text-align:center;"><img src="images/3dpurevb4a.png" style="vertical-align: bottom; position:relative; display: inline-block; width:100%; min-width:300px; max-width:1280px; background:none; " id="img_3148d828" alt="" title="" />
</div>
<div style="text-align:left;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#000000; "><br/><br/></span></div>
<div style="text-align:justify;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">Once all triangles are calculated and stored into the</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; "> IndexBuffer</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">, we can now proceed to the final rendering (</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">Render</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> module). Triangles datas stored in the</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; "> IndexBuffer</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> are read then sorted in Z order from the farthest to the nearest (relative to the point of view) to be drawn on screen with the</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; "> DrawTriangle</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> &#160;procedure (</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; ">GDIPlus </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">module). This rendering method is also called</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; font-weight:bold; "> the painter's algorythm.</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><br/><br/><br/></span></div>
<div style="text-align:center;"><img src="images/3dpurevb5a.png" style="vertical-align: bottom; position:relative; display: inline-block; width:100%; min-width:300px; max-width:1280px; background:none; " id="img_1e96eab0" alt="" title="" />
</div>
<div style="text-align:left;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#000000; "><br/><br/></span></div>
<div style="text-align:justify;"><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">This small project was written with </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">VbDotNet</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">, but I think with some will and a little bit of work it can easily be re-written with another programming language like </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">C#</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> or </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">Javascript</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">. As explained, the goal is just to make you understand the core logic of a 3d engine.<br/><br/>You have probably understand that the used </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">API </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">for rendering is</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; "> GDI+</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; ">. This one will quickly show &#160;its limits by rendering more complexe scenes with a big amount of polygons. At this time it will be useful to consider some other solutions, certainly more complex but also more powerful like </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">DirectX</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> , </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; ">OpenGL</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> or</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; font-style:italic; "> WebGL</span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> (if you target web dev with Javascript as exemple) to have the benefit of hardware accelerated power.<br/><br/>Thats it! Now all you have to do is to take your keyboard and start studying the code. I hope my explanations was understandable enought, and that you will enjoy learning with this little project as I enjoyed developping it!<br/><br/>Sylvain SIMON (SylFx)<br/><br/>Date of first publication: Juny 24, 2013 - Latest update: February 21, 2017. <br/>&#169;2013-2017 Sylvain SIMON. </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><a href="http://www.sylfx.net">www.sylfx.net</a></span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "> - </span><span style="font-size:12pt; font-family:Arial, Helvetica, sans-serif; color:#506478; "><a href="https://www.github.com/sylfx">www.github.com/sylfx</a></span></div>
</div>  </div>
</body>
</html>